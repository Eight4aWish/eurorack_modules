[platformio]
default_envs = pico2w_oc
src_dir = src

[env]
lib_extra_dirs = libs
monitor_speed = 115200
build_flags =
  -O2
  -fno-rtti
  -fno-exceptions
extra_scripts = scripts/copy_artifacts.py   ; <--- add this line

; Daisy Seed (DaisyDuino)
[env:daisy-mfx]
platform      = ststm32
board         = electrosmith_daisy
framework     = arduino
lib_deps      =
  https://github.com/electro-smith/DaisyDuino.git#v1.7.0
  adafruit/Adafruit SSD1306@^2.5.15
  adafruit/Adafruit GFX Library@^1.12.3
build_src_filter = -<*> +<daisy-mfx/>

build_flags   =
  ${env.build_flags}
  -DPLATFORM_DAISY
  -Iinclude/daisy-mfx
  -DHAL_SDRAM_MODULE_ENABLED
  -DUSE_FMC
  ; Optional cosmetic USB strings (safe):
  -DUSB_PRODUCT="\"DaisyMFX\""
  -DUSB_MANUFACTURER="\"Daisy\""

board_build.usb_mode = CDC
upload_protocol = dfu
upload_command  = dfu-util -a 0 -s 0x08000000:leave -D $PROJECT_BUILD_DIR/$PIOENV/firmware.bin || true
monitor_speed   = 115200

; Teensy 4.1
[env:teensy41]
platform     = teensy
board        = teensy41
framework    = arduino
lib_deps     =
  adafruit/Adafruit SSD1306@^2.5.15
  adafruit/Adafruit GFX Library@^1.12.3
build_src_filter = -<*> +<teensy-move/>
build_flags  =
  ${env.build_flags}
  -DPLATFORM_TEENSY
  -Iinclude/teensy-move
  -D USB_MIDI_AUDIO_SERIAL
  -DUSE_STATIC_CALIB
upload_protocol = teensy-cli

; Teensy 4.1 V2 â€” Optimized MIDI timing
[env:teensy41_v2]
platform     = teensy
board        = teensy41
framework    = arduino
lib_deps     =
  adafruit/Adafruit SSD1306@^2.5.15
  adafruit/Adafruit GFX Library@^1.12.3
build_src_filter = -<*> +<teensy-move-v2/>
build_flags  =
  ${env.build_flags}
  -DPLATFORM_TEENSY
  -Iinclude/teensy-move-v2
  -D USB_MIDI_AUDIO_SERIAL
  -DUSE_STATIC_CALIB
upload_protocol = teensy-cli

; Pico 2 W
[env:pico2w_oc]
platform      = https://github.com/maxgerhardt/platform-raspberrypi.git
board         = rpipico2w
framework     = arduino
lib_deps      =
  adafruit/Adafruit SSD1306 @ ^2.5.15
  adafruit/Adafruit GFX Library @ ^1.12.3
  adafruit/Adafruit MCP4728 @ ^1.0.10
  adafruit/Adafruit ADS1X15 @ ^2.6.0
  thomasfredericks/Bounce2 @ ^2.72
build_src_filter = -<*> +<pico2w_oc/>
build_flags   =
  ${env.build_flags}
  -DPLATFORM_PICO
  -Iinclude/pico2w_oc
  -DUSE_STATIC_CALIB
upload_protocol = picotool

; Pico 2 W Calibration CLI (removed; use OLED Diagnostics + static fits)

; ESP32 Dev Module
[env:esp32dev]
platform = espressif32 @ 6.12.0
board = esp32dev
framework = arduino
monitor_speed = 115200

build_src_filter = -<*> +<esp32oscclk/>
build_flags   =
  ${env.build_flags}
  -DPLATFORM_ESP32
  -Iinclude/esp32oscclk

lib_ldf_mode = chain
lib_compat_mode = soft

lib_deps =
  adafruit/Adafruit MCP4728@^1.0.10

; keep anything web-related out
lib_ignore = ESPAsyncWebServer AsyncTCP ElegantOTA AsyncElegantOTA RPAsyncTCP

